<!doctype html>
<html lang="pt-BR">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Gerador de Notas de Loca√ß√£o</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <style>
    body { background:#f1f5f9; color:#111; }
    .box { border:1.5px solid #1f2937; }
    .title { background:#e5e7eb; font-weight:600; padding:6px 10px; border-bottom:1.5px solid #1f2937; }
    @media print {
      .no-print { display:none!important; }
      body { background:white; }
      .shadow-xl{ box-shadow:none; }
    }
  </style>
</head>
<body class="max-w-4xl mx-auto p-4">
  <h1 class="text-2xl font-bold mb-4">üßæ Gerador de Notas de Loca√ß√£o</h1>

  <!-- Sele√ß√£o de cliente -->
  <div class="no-print flex gap-2 mb-4">
    <select id="clientSelect" class="border rounded px-2 py-2 text-sm min-w-[240px]"></select>
    <button id="btnAddClient" class="px-3 py-2 rounded bg-indigo-600 text-white">+ Cliente</button>
    <button id="btnManageClients" class="px-3 py-2 rounded border">Gerenciar</button>
  </div>

  <!-- Nota -->
  <div id="nota" class="bg-white shadow-xl rounded-xl overflow-hidden box p-4">
    <h2 class="text-center font-bold text-lg mb-2">TRANSELIAN TRANSPORTES LTDA - ME</h2>
    <div class="text-sm mb-2">CNPJ: 07.958.145/0001-49 - CONTATO: (31) 99633-1518</div>

    <div class="title">Destinat√°rio</div>
    <div class="grid grid-cols-2 gap-2 text-sm p-2">
      <div><label>Raz√£o Social</label><input id="clientName" class="border rounded w-full p-1"/></div>
      <div><label>CNPJ/CPF</label><input id="clientDoc" class="border rounded w-full p-1"/></div>
      <div><label>Endere√ßo</label><input id="clientAddr" class="border rounded w-full p-1"/></div>
      <div><label>Cidade/UF</label><input id="clientCity" class="border rounded w-full p-1"/></div>
    </div>

    <div class="title">Contrato</div>
    <div class="grid grid-cols-2 gap-2 text-sm p-2">
      <div><label>N√∫mero</label><input id="contractNum" class="border rounded w-full p-1"/></div>
      <div><label>Valor Mensal</label><input id="monthlyValue" type="number" class="border rounded w-full p-1"/></div>
    </div>

    <div class="title">Dados da Loca√ß√£o</div>
    <div class="p-2 text-sm">
      <textarea id="items" rows="4" class="border rounded w-full p-2" placeholder="Descri√ß√£o dos itens..."></textarea>
    </div>

    <div class="title">Observa√ß√µes</div>
    <div class="p-2 text-sm">
      <textarea id="notes" rows="3" class="border rounded w-full p-2"></textarea>
    </div>

    <div class="text-right font-bold mt-2">Total: <span id="totalView">R$ 0,00</span></div>
  </div>

  <!-- A√ß√µes -->
  <div class="no-print flex gap-2 mt-4">
    <button id="btnSaveCurrent" class="px-3 py-2 rounded border">Salvar rascunho</button>
    <button id="btnLoadCurrent" class="px-3 py-2 rounded border">Carregar</button>
    <button id="btnPrint" class="px-3 py-2 rounded bg-emerald-600 text-white">Baixar/Imprimir PDF</button>
  </div>

  <script>
    const $ = (s)=>document.querySelector(s);
    const store={set:(k,v)=>localStorage.setItem(k,JSON.stringify(v)),get:(k,d=null)=>{try{return JSON.parse(localStorage.getItem(k))??d;}catch{return d;}},del:(k)=>localStorage.removeItem(k)};

    const inputs={clientName:$('#clientName'),clientDoc:$('#clientDoc'),clientAddr:$('#clientAddr'),clientCity:$('#clientCity'),contractNum:$('#contractNum'),monthlyValue:$('#monthlyValue'),items:$('#items'),notes:$('#notes')};

    const clientSelect=$('#clientSelect');
    let clients=store.get('clients',[]);

    function renderClients(){
      clientSelect.innerHTML='<option value="">‚Äî selecionar ‚Äî</option>';
      clients.forEach(c=>{const o=document.createElement('option');o.value=c.id;o.textContent=c.name;clientSelect.appendChild(o);});
    }

    function saveClient(c){
      const idx=clients.findIndex(x=>x.id===c.id);
      if(idx>=0) clients[idx]=c; else clients.push(c);
      store.set('clients',clients);
      renderClients();
    }

    function fillClient(c){
      inputs.clientName.value=c.name;
      inputs.clientDoc.value=c.doc;
      inputs.clientAddr.value=c.addr;
      inputs.clientCity.value=c.city;
    }

    $('#btnAddClient').addEventListener('click',()=>{
      const name=prompt('Raz√£o Social:'); if(!name) return;
      const doc=prompt('CNPJ/CPF:');
      const addr=prompt('Endere√ßo:');
      const city=prompt('Cidade/UF:');
      const c={id:crypto.randomUUID(),name,doc,addr,city};
      saveClient(c);
    });

    clientSelect.addEventListener('change',()=>{
      const c=clients.find(x=>x.id===clientSelect.value);
      if(c) fillClient(c);
    });

    $('#btnSaveCurrent').addEventListener('click',()=>{store.set('nota',capture());alert('Rascunho salvo');});
    $('#btnLoadCurrent').addEventListener('click',()=>{const d=store.get('nota');if(d) apply(d);});
    $('#btnPrint').addEventListener('click',()=>window.print());

    function capture(){
      return {clientName:inputs.clientName.value,clientDoc:inputs.clientDoc.value,clientAddr:inputs.clientAddr.value,clientCity:inputs.clientCity.value,contractNum:inputs.contractNum.value,monthlyValue:inputs.monthlyValue.value,items:inputs.items.value,notes:inputs.notes.value};
    }
    function apply(d){for(const k in inputs){if(inputs[k]) inputs[k].value=d[k]||'';}}

    renderClients();
  </script>
</body>
</html>
